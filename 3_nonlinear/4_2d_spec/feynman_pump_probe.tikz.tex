\newcommand{\myarrow}[5]{\draw[#4](#1.south -| #2)  -- ++(#3 :6mm) node[above,pos=1]{$#5$};
} 

\newcommand{\interactLp}[3]{\myarrow{#1-#2-1}{#1.west}{-135}{<-}{#3}} 
\newcommand{\interactLm}[3]{\myarrow{#1-#2-1}{#1.west}{+135}{->}{#3}} 
\newcommand{\interactRp}[3]{\myarrow{#1-#2-2}{#1.east}{ -45}{<-}{#3}} 
\newcommand{\interactRm}[3]{\myarrow{#1-#2-2}{#1.east}{ +45}{->}{#3}}  

\newcommand{\interactout}[2]{\myarrow{#1-1-1}{#1.west}{+135}{->,dashed}{#2}} 

\begin{tikzpicture}[
     every left delimiter/.style={xshift=0.6em},
     every right delimiter/.style={xshift=-1em} ,  
     mymat/.style={
    matrix of math nodes,
    left delimiter=|, right delimiter=|,
    align=center,
    column sep=-\pgflinewidth,
}]


\useasboundingbox (0.,0) rectangle (10.6,8.3);

\tikzmath{ \y1 = 1.8; \x1 = 1.1; \dx = 2.7; \y2 = 6;}

%\draw (0.,0) rectangle (10.6,8.3);

%-------------
\matrix[mymat] at (\x1,\y1) (mat1)
{   0 & 0\\
    1 & 0\\
    0 & 0\\
     1 & 0\\
    0 & 0\\
};

\interactout{mat1}{out};
\interactLp{mat1}{2}{pr};
\interactLm{mat1}{3}{pu};
\interactLp{mat1}{4}{pu};



%-------------
\matrix[mymat] at (\x1 + 1 * \dx,\y1) (mat2)
{   0 & 0\\
    1 & 0\\
    0 & 0\\
     0 & 1\\
    0 & 0\\
};

\interactout{mat2}{out};
\interactLp{mat2}{2}{pr};
\interactRm{mat2}{3}{pu};
\interactRp{mat2}{4}{pu};



%-------------
\matrix[mymat] at (\x1 + 2 * \dx,\y1) (mat3)
{   -1 & -1\\
    0 & -1\\
    0 & 0\\
     1 & 0\\
    0 & 0\\
};

\interactout{mat3}{out};
\interactRm{mat3}{2}{pr};
\interactLm{mat3}{3}{pu};
\interactLp{mat3}{4}{pu};

%-------------
\matrix[mymat] at (\x1 + 3 * \dx,\y1) (mat4)
{   -1 & -1\\
    0 & -1\\
    0 & 0\\
     0 & 1\\
    0 & 0\\
};

\interactout{mat4}{out};
\interactRm{mat4}{2}{pr};
\interactRm{mat4}{3}{pu};
\interactRp{mat4}{4}{pu};




%-------------
\matrix[mymat] at (\x1,\y2) (mat5)
{   0 & 0\\
    1 & 0\\
    1 &1\\
     1 & 0\\
    0 & 0\\
};

\interactout{mat5}{out};
\interactRm{mat5}{2}{pr};
\interactRp{mat5}{3}{pu};
\interactLp{mat5}{4}{pu};



%-------------
\matrix[mymat] at (\x1 + 1 * \dx,\y2) (mat6)
{   0 & 0\\
    1 & 0\\
    1 & 1\\
     0 & 1\\
    0 & 0\\
};

\interactout{mat6}{out};
\interactRm{mat6}{2}{pr};
\interactLp{mat6}{3}{pu};
\interactRp{mat6}{4}{pu};



%-------------
\matrix[mymat] at (\x1 + 2 * \dx,\y2) (mat7)
{   1 & 1\\
    2 & 1\\
    1 & 1\\
     1 & 0\\
    0 & 0\\
};

\interactout{mat7}{out};
\interactLp{mat7}{2}{pr};
\interactRp{mat7}{3}{pu};
\interactLp{mat7}{4}{pu};

%-------------
\matrix[mymat] at (\x1 + 3 * \dx,\y2) (mat8)
{   1 & 1\\
    2 & 1\\
    1 & 1\\
     0 & 1\\
    0 & 0\\
};

\interactout{mat8}{out};
\interactLp{mat8}{2}{pr};
\interactLp{mat8}{3}{pu};
\interactRp{mat8}{4}{pu};






\node[draw,yshift=5mm] at (mat1.north) {b3};
\node[draw,yshift=5mm] at (mat2.north) {b4};
\node[draw,yshift=5mm] at (mat3.north) {a3};
\node[draw,yshift=5mm] at (mat4.north) {a4};

\node[draw,yshift=5mm] at (mat5.north) {a1};
\node[draw,yshift=5mm] at (mat6.north) {a2};
\node[draw,yshift=5mm] at (mat7.north) {b1};
\node[draw,yshift=5mm] at (mat8.north) {b2};

\path (mat1.south) -- (mat2.south) node [midway,below] {ground state bleaching};
\path (mat3.south) -- (mat4.south) node [midway,below] {not allowed};

\path (mat5.south) -- (mat6.south) node [midway,below] {stimulated emission};
\path (mat7.south) -- (mat8.south) node [midway,below] {excited state absorption};

\end{tikzpicture}
